<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fila.app.mapper.eventProduct.EventProductMapper">

    <select id="selectActiveEventKeywords" resultType="com.fila.app.domain.event.EventProductVO">
        SELECT EVENT_NAME, SLUG, EVENT_ID 
        FROM EVENT 
        WHERE IS_ACTIVE = 1 
        ORDER BY EVENT_ID DESC
    </select>

    <select id="selectRecommendProductKeywords" resultType="com.fila.app.domain.event.EventProductVO">
        SELECT NAME, PRODUCT_ID 
        FROM (
            SELECT p.NAME, p.PRODUCT_ID 
            FROM EVENT_PRODUCT ep 
            JOIN PRODUCTS p ON ep.PRODUCT_ID = p.PRODUCT_ID
        ) WHERE ROWNUM &lt;= 5
    </select>

    <select id="selectRecommendProducts" resultType="com.fila.app.domain.event.EventProductVO">
        SELECT * FROM (
            SELECT p.PRODUCT_ID, p.NAME, p.PRICE, p.DISCOUNT_RATE,
                   (SELECT IMAGE_URL FROM PRODUCT_IMAGE pi 
                    WHERE pi.PRODUCT_ID = p.PRODUCT_ID 
                      AND pi.IMAGE_TYPE = 'MAIN' AND ROWNUM = 1) as mainImageUrl
            FROM EVENT_PRODUCT ep 
            JOIN PRODUCTS p ON ep.PRODUCT_ID = p.PRODUCT_ID 
            ORDER BY p.PRODUCT_ID DESC
        ) WHERE ROWNUM &lt;= 12
    </select>

</mapper>